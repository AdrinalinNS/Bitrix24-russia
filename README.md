Перечень скриптов:
ChatID.php - скрипт для получения информации ID чатов, нужен только в начале настройки
helpers.php - скрипт для определения пола, нужен всегда
BirthdayB24.php - скрипт для поздравления 
!!не забыть файлам которые используются автозапуском Cron выставить права чтения+исполнения

Скрипт для Bitrix24, который:
1.	Получает список сотрудников.
2.	Находит тех, у кого сегодня день рождения, определяет пол, берет случайную открытку из списка открыток разбитых по половому признаку в начале скрипта
3.	Запрашивает персонализированное поздравление через Yandex GPT API. (для каждого сотрудника отдельно)
4.	Отправляет сгенерированное сообщение в чат Bitrix24. (для каждого сотрудника отдельно)
________________________________________
1. Подготовка
Что нужно заранее:
1.	Вебхук Bitrix24 (в меню Разработчикам - Другое - Входящий вебхук. Копируем URL и задаем там права на чат "im" и на анкеты пользователй "user")
2.	IAM токен Yandex Cloud (получите в консоли Yandex Cloud). Доступен либо в тестовый период (2 месяца) либо после тестового после оплаты. (Для компании пришлось подтвердить данные)
3.	ID каталога Yandex Cloud (указан в консоли). (можно взять дефолтный, можно его и переименовать, а можно сделать новый в тестовом или после оплаты)
4.	Сервисный аккаунт с ролью ai.languageModels.user. (расписывать долго, спроси у яндекса)

3. Как это работает
1.	Получение списка сотрудников.
2.	Проверка даты рождения — преобразует и сравнивает m-d сегодня и в профиле. Если у него сегодня ДР - заполняет массив, случайно выбирает открытку из списка ссылок на открытки с определением пола.
3.	Делает запрос к Yandex GPT по массиву сотрудников у которых сегодня ДР.
4.	Формирует индивидуальный промпт в andex GPT с Фамилией и Именем сотрудника.
5.	Отправляет запрос к API Yandex GPT.
6.	Получает сгенерированный текст, 
8.  Убирает лишнее из ответа Yandex GPT (типа [Ваше_Имя]) и заносит его в массив этому сотруднику.
4.	Отправка в Bitrix24 — использует im.message.add., делает отправку на каждого сотрудника отдельным сообщением.
5.	Резервное сообщение — если GPT не ответил, отправляется шаблоный текст.
________________________________________

Требуется:
Сервер с доступом в интернет и установленным PHP

в моем случае использую в Ubuntu 22 :

ставим PHP 7.4++

add-apt-repository ppa:ondrej/php
apt-get update
export PHP_VER=8.2
sudo apt install php${PHP_VER}-fpm php${PHP_VER}-common php${PHP_VER}-zip php${PHP_VER}-xml php${PHP_VER}-intl php${PHP_VER}-gd php${PHP_VER}-mysql php${PHP_VER}-mbstring php${PHP_VER}-curl php${PHP_VER}-imagick libapache2-mod-fcgid php${PHP_VER}-gmp php${PHP_VER}-bcmath libmagickcore-6.q16-6-extra

правильная дата/время

sudo apt install chrony
systemctl enable chrony
timedatectl set-timezone Asia/Vladivostok
